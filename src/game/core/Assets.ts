// Helper to create a canvas with pixel data
function createCanvasFromPixels(width: number, height: number, palette: string[], pixels: number[]): HTMLCanvasElement {
    const canvas = document.createElement('canvas');
    canvas.width = width;
    canvas.height = height;
    const ctx = canvas.getContext('2d')!;

    for (let y = 0; y < height; y++) {
        for (let x = 0; x < width; x++) {
            const colorIndex = pixels[y * width + x];
            if (colorIndex > 0) {
                ctx.fillStyle = palette[colorIndex - 1];
                ctx.fillRect(x, y, 1, 1);
            }
        }
    }
    return canvas;
}

export const Assets = {
    // Simple 16x16 Player Sprite
    player: () => {
        const w = 16;
        const h = 16;
        const palette = ['#4a9eff', '#2563eb', '#1e40af', '#f5f5f5', '#ffd700'];
        
        const pixels = [
            0,0,0,0,0,5,5,5,5,0,0,0,0,0,0,0,
            0,0,0,0,5,5,4,4,5,5,0,0,0,0,0,0,
            0,0,0,1,1,4,4,4,4,1,1,0,0,0,0,0,
            0,0,1,1,4,4,4,4,4,4,1,1,0,0,0,0,
            0,0,1,1,4,4,4,4,4,4,1,1,0,0,0,0,
            0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,
            0,0,2,2,1,1,1,1,1,2,2,0,0,0,0,0,
            0,0,2,2,2,1,1,1,2,2,2,0,0,0,0,0,
            0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,
            0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0,
            0,0,0,3,3,2,2,2,3,3,0,0,0,0,0,0,
            0,0,0,3,3,3,0,3,3,3,0,0,0,0,0,0,
            0,0,0,0,3,3,0,3,3,0,0,0,0,0,0,0,
            0,0,0,0,3,3,0,3,3,0,0,0,0,0,0,0,
            0,0,0,3,3,0,0,0,3,3,0,0,0,0,0,0,
            0,0,0,3,3,0,0,0,3,3,0,0,0,0,0,0,
        ];
        return createCanvasFromPixels(w, h, palette, pixels);
    },

    // Simple 8x8 Projectile
    projectile: () => {
        const w = 8;
        const h = 8;
        const palette = ['#ecc94b', '#ffd700', '#fff'];
        
        const pixels = [
            0,0,0,1,1,0,0,0,
            0,0,2,2,2,2,0,0,
            0,2,3,3,3,3,2,0,
            1,2,3,3,3,3,2,1,
            1,2,3,3,3,3,2,1,
            0,2,3,3,3,3,2,0,
            0,0,2,2,2,2,0,0,
            0,0,0,1,1,0,0,0,
        ];
        return createCanvasFromPixels(w, h, palette, pixels);
    },

    // Simple Enemy Sprites
    enemy: (type: string = "basic") => {
        const w = 16;
        const h = 16;
        
        if (type === "fast") {
            const palette = ['#e53e3e', '#c53030', '#000'];
            const pixels = [
                0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,
                0,0,0,1,1,2,2,2,2,1,1,0,0,0,0,0,
                0,0,1,1,2,3,2,2,3,2,1,1,0,0,0,0,
                0,1,1,2,2,2,2,2,2,2,2,1,1,0,0,0,
                1,1,2,2,2,2,2,2,2,2,2,2,1,1,0,0,
                1,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0,
                1,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0,
                1,2,2,2,2,3,3,3,3,2,2,2,2,1,0,0,
                1,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0,
                1,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0,
                1,1,2,2,2,2,2,2,2,2,2,2,1,1,0,0,
                0,1,1,2,2,2,2,2,2,2,2,1,1,0,0,0,
                0,0,1,1,2,2,2,2,2,2,1,1,0,0,0,0,
                0,0,0,1,1,2,2,2,2,1,1,0,0,0,0,0,
                0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,
                0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
            ];
            return createCanvasFromPixels(w, h, palette, pixels);
        }
        
        // Default basic enemy
        const palette = ['#48bb78', '#38a169', '#000'];
        const pixels = [
            0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,
            0,0,0,1,1,2,2,2,2,1,1,0,0,0,0,0,
            0,0,1,1,2,3,2,2,3,2,1,1,0,0,0,0,
            0,1,1,2,2,2,2,2,2,2,2,1,1,0,0,0,
            1,1,2,2,2,2,2,2,2,2,2,2,1,1,0,0,
            1,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0,
            1,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0,
            1,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0,
            1,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0,
            1,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0,
            1,1,2,2,2,2,2,2,2,2,2,2,1,1,0,0,
            0,1,1,2,2,2,2,2,2,2,2,1,1,0,0,0,
            0,0,1,1,2,2,2,2,2,2,1,1,0,0,0,0,
            0,0,0,1,1,2,2,2,2,1,1,0,0,0,0,0,
            0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,
            0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
        ];
        return createCanvasFromPixels(w, h, palette, pixels);
    },
};
